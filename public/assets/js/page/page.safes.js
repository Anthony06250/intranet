$(document).ready(function(){"use strict";new Safe});class Safe{constructor(){this.init()}init(){this.calcAllTotals(),this.calcAllBalances()}calcAllTotals(){var a=$("#safes-datatable thead tr th:not(:first, :last)").length;for(let t=1;t<=a;t++)this.calcTotalForColumn(t+1)}calcAllBalances(){var a=$("#safes-datatable tbody tr").length;for(let t=1;t<=a;t++)this.calcBalanceForRow(t);this.displayLastBalance()}calcTotalForColumn(t){let a=0;$("#safes-datatable tbody tr td:nth-child("+t+") a.text-reset").each(function(){a+=$(this).text().toNumber()}),$("#safes-datatable tfoot tr th:nth-child("+t+")").text(a?a.toCurrency():"0,00 €"),this.colorColumn(t,a)}calcBalanceForRow(t){let a=0;$("#safes-datatable tbody tr:nth-child("+t+") a.text-reset:not(:last)").each(function(){a+=$(this).text().toNumber()});var e=$("#safes-datatable tbody tr:nth-child("+t+") td:last a.text-reset"),l=e.text().toNumber(),s=$("#safes-datatable tbody tr:nth-child("+(t-1)+") td:last a.text-reset").text().toNumber()||$("#safes-datatable tbody tr:nth-child("+(t-1)+") td:last").text().toNumber(),s=l?l+a:s+a;l?e.text(s.toCurrency()).parent().addClass("fw-bold"):$("#safes-datatable tbody tr:nth-child("+t+") td:last").text(s.toCurrency()),this.colorBalance(t,s)}displayLastBalance(){var t=(t=$("#safes-datatable tbody tr:last td:last a.text-reset").text().toNumber())||$("#safes-datatable tbody tr:last td:last").text().toNumber();$("#safes-datatable tfoot tr th:last").text(t?t.toCurrency():"0,00 €"),this.colorColumn($("#safes-datatable tfoot tr th").length,t)}colorColumn(t,a){a=this.getColor(a);$("#safes-datatable tfoot tr th:nth-child("+t+")").addClass(a)}colorBalance(t,a){a=this.getColor(a);$("#safes-datatable tbody tr:nth-child("+t+") td:last").addClass(a)}getColor(t){let a;switch(!0){case 0<t:a="text-success";break;case t<0:a="text-danger"}return a}}String.prototype.toNumber=function(){return Number(this.replace(/[^0-9-]+/g,""))/100},Number.prototype.toCurrency=function(){return new Intl.NumberFormat($("html").attr("lang"),{style:"currency",currency:"EUR"}).format(this)};